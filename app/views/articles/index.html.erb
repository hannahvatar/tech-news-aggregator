<h1>Articles</h1>

<!-- Date Range Filter Form -->
<%= form_tag(articles_path, method: :get, class: "date-filter-form") do %>
  <div>
    <label for="start_date">Start Date:</label>
    <%= date_field_tag :start_date, params[:start_date], class: "date-input" %>
  </div>
  <div>
    <label for="end_date">End Date:</label>
    <%= date_field_tag :end_date, params[:end_date], class: "date-input" %>
  </div>
  <div>
    <%= submit_tag "Filter", class: "filter-button" %>
  </div>
<% end %>

<% @combined_articles.each do |article| %>
  <div class="article-preview">
    <h2><%= link_to article.title, article_path(article) %></h2>
    <p>Source:
      <% if article.is_a?(ScrapedArticle) %>
        <%= article.scraped_feed.name %>
      <% else %>
        <%= article.feed.name %>
      <% end %>
    </p>
    <p>Published: <%= article.published_at.strftime("%B %d, %Y") %></p>

    <!-- AI Summary Section -->
    <% if article.is_a?(Article) && article.ai_summary.present? %>
      <h3>AI Summary</h3>
      <p><%= simple_format(article.ai_summary.content) %></p>
    <% elsif article.is_a?(ScrapedArticle) && article.article&.ai_summary.present? %>
      <h3>AI Summary</h3>
      <p><%= simple_format(article.article.ai_summary.content) %></p>
    <% else %>
      <p>No AI Summary available</p>
    <% end %>

    <hr>
  </div>
<% end %>

<%= paginate @combined_articles %> <!-- Pagination controls -->
