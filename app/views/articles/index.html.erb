<h1>Tech News Aggregator</h1>

<!-- Filter Form -->
<%= form_with url: articles_path, method: :get, local: true do %>
  <label for="start_date">Start Date:</label>
  <%= date_field_tag :start_date, params[:start_date] %>

  <label for="end_date">End Date:</label>
  <%= date_field_tag :end_date, params[:end_date] %>

  <%= submit_tag "Filter", class: "btn btn-primary" %>
<% end %>

<hr>

<% if @articles.any? %>
  <% @articles.each do |article| %>
    <div class="article">
      <h2>
        <a href="<%= article.url %>" target="_blank">
          <%= article.title %>
        </a>
      </h2>
      <p><strong>Published:</strong> <%= article.published_at.strftime("%B %d, %Y") %></p>
      <p><strong>Feed:</strong> <%= article.feed&.name || "Unknown" %></p>

      <% if article.ai_summary %>
        <h3>AI Summary:</h3>
        <p><%= article.ai_summary.content %></p>
      <% else %>
        <p><em>No AI Summary available.</em></p>
      <% end %>

      <% if article.key_facts.any? %>
        <h3>Key Facts:</h3>
        <ul>
          <% article.key_facts.each do |fact| %>
            <li><%= fact.content %></li>
          <% end %>
        </ul>
      <% end %>
    </div>
    <hr>
  <% end %>
<% else %>
  <p>No articles found.</p>
<% end %>
