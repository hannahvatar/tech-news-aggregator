<div class="container mx-auto px-4 py-8">
  <!-- Header -->
  <div class="mb-6 flex justify-between items-center">
    <h1 class="text-3xl font-bold">Tech Insights Report</h1>
    <%= link_to 'Generate New Report', new_report_path,
        class: "bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 transition duration-300" %>
  </div>

  <!-- Report Overview -->
  <div class="bg-white shadow-md rounded-lg p-6 mb-6">
    <h2 class="text-2xl font-bold mb-4">Report Overview</h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div>
        <p class="text-gray-600">Date Range</p>
        <p class="font-medium"><%= @report.data.dig("metadata", "date_range") %></p>
      </div>
      <div>
        <p class="text-gray-600">Articles Analyzed</p>
        <p class="font-medium"><%= @report.data.dig("metadata", "article_count") %></p>
      </div>
      <div>
        <p class="text-gray-600">Generated On</p>
        <p class="font-medium"><%= DateTime.parse(@report.data.dig("metadata", "generated_at")).strftime('%B %d, %Y %H:%M') rescue @report.created_at.strftime('%B %d, %Y %H:%M') %></p>
      </div>
    </div>

    <!-- Article Sources -->
    <div class="mt-4">
      <h3 class="text-xl font-semibold mb-2">Sources</h3>
      <div class="space-y-2">
        <% @report.data.dig("metadata", "articles")&.each do |article| %>
          <div class="bg-gray-100 p-3 rounded-md">
            <p class="font-medium"><%= article["title"] %></p>
            <p class="text-sm text-gray-600">
              Source: <%= article["source"] %> |
              Published: <%= article["published_at"] %>
            </p>
            <a href="<%= article["url"] %>"
               target="_blank"
               class="text-blue-600 hover:underline text-sm">
              Read Article
            </a>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <!-- AI-Generated Report -->
  <div class="bg-white shadow-md rounded-lg p-6 mt-6">
    <h2 class="text-2xl font-bold mb-4">Tech Trends Analysis</h2>
    <% if @report.data["analysis"].present? %>
      <div class="prose max-w-none">
        <%= simple_format(@report.data["analysis"]) %>
      </div>
    <% else %>
      <p class="text-gray-600">No analysis available.</p>
    <% end %>
  </div>
</div>
